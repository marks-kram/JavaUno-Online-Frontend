<!Doctype html>
<html lang="de" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <title>JavaUno Online</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta property="og:title" content="JavaUno Online">
    <meta property="og:description" content="Spiele das beliebte Kartenspiel mit Freunden oder auch alleine am PC oder Handy.">
    <meta property="og:image" content="/res/img/og.png">
    <meta property="og:image:secure_url" content="/res/img/og.png">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" type="text/css" href="/res/css/general.css">
    <link rel="stylesheet" type="text/css" href="/res/css/view-start.css">
    <link rel="stylesheet" type="text/css" href="/res/css/view-set-players.css">
    <link rel="stylesheet" type="text/css" href="/res/css/view-game.css">
    <link rel="stylesheet" type="text/css" href="/res/css/toast.css">
    <script src="/res/js/vue-core.js"></script>
    <script src="/res/js/vue-cookies.js"></script>
    <script src="/res/js/vue-resource.js"></script>
    <script src="/res/js/toast.js"></script>
    <script src="/res/js/qr.js"></script>
</head>
<body>
    <header>
        <img src="/res/img/logo.png" alt="">
    </header>
    <noscript>JavaUno als Browsergame basiert auf JavaScript. Bitte aktiviere JavaScript in deinen Browsereinstellungen.</noscript>

    <div id="javaUno">

        <!-- Start/Join view - From here a game can be created or joined -->
        <div id="view-start" v-if="currentView === 'start' || currentView === 'join'">
            <p v-if="!invention">
                Spiele das beliebte Kartenspiel UNO online am PC oder Smartphone.<br>
                Du kannst mit Freunden spielen oder aber auch alleine gegen computergesteuerte Gegner.
            </p>
            <p v-if="invention">
                Mach' mit beim beliebten Kartenspiel UNO.<br>
                Du wurdest eingeladen, mitzuspielen. Viel Spaß!
            </p>
            <input v-if="currentView === 'join'" type="text" v-model="name" placeholder="Name (optional)">
            <button v-if="currentView === 'start'" @click="createGame()">Spielspaß beginnen</button>
            <button v-if="currentView === 'join'" @click="joinGame()"
                    v-bind:disabled="gameState.players.length >= 9 || gameState.game.gameLifecycle == 'RUNNING'">
                <span v-if="invention">Jetzt mitspielen</span>
                <span v-if="!invention">Jetzt loslegen</span>
            </button>
            <div  class="errMsg" v-if="currentView === 'join' && gameState.players.length >= 9">
                Die maximale Spieleranzahl ({{9}}) wurde erreicht.
            </div>
            <div  class="errMsg" v-if="currentView === 'join' && gameState.game.gameLifecycle == 'RUNNING'">
                Das Spiel wurde bereits gestartet.
            </div>
            <div  class="errMsg"
                  v-if="currentView === 'join' && (gameState.players.length >= 9 || gameState.game.gameLifecycle == 'RUNNING')">
                Es können leider keine weiteren Spieler teilnehmen.<br>
                <button class="small" @click="reset()">Eigenes Spiel starten</button>
            </div>
        </div>

        <!-- Set players view - From here Players can be added and removed and game round can be started -->
        <div id="view-set-players" v-if="currentView === 'set_players'">
            <h3>Aktuelle Spieler ({{gameState.players.length}})</h3>
            <div id="current-players">
                <div class="player" v-for="(player, index) in gameState.players">
                    {{ player.name != '' ? player.name : 'Spieler ' + (index+1) }}
                    <span v-if="index == gameState.myIndex">(Du)</span>
                    <button v-if="index == gameState.myIndex" class="small" @click="leaveGame()">Spiel verlassen</button>
                    <button v-if="player.bot" class="small" @click="removeBot(player)">Bot entfernen</button>
                </div>
            </div>
            <h3>Spieler hinzufügen</h3>
            <div id="add-players" v-if="gameState.players.length < 9">
                Computergesteuerten Gegner
                <input class="small" type="text" v-model="botName" placeholder="Name (optional)">
                <button class="small" @click="addBot()">hinzufügen</button><br><br>
                Freunde einladen:<br>
                Schicke deinen Freunden folgenden Link:<br>
                <button class="small" @click="copyLink()">Kopieren</button>
                <textarea id="invention-link-toCopy">https://{{hostname}}/invention.html#{{gameUuid}}</textarea>
                <span id="invention-link">https://{{hostname}}/invention.html#{{gameUuid}}</span>
                <br><br>
                Oder, wenn sie eh bei dir sind, lasse einfach den
                <button class="small" @click="showQrCode()">QR-Code scannen</button>
                <div id="invention-qr" v-show="showQr">
                    <div id="invention-qr-code"></div>
                    <button class="small" @click="showQr = false">ausblenden</button>
                </div>
            </div>
            <div id="add-players-limit-reached" v-if="gameState.players.length >= 9">
                Die maximale Spieleranzahl ({{9}}) wurde erreicht.<br>
                Es können keine weiteren Spieler teilnehmen.
            </div>
            <div id="start-game">
                <button @click="startGame()"
                        v-bind:disabled="gameState.players.length < 2">Spiel starten</button>
                <div class="errMsg" v-if="gameState.players.length < 2">
                    Es werden mindestens 2 Spieler benötigt.
                </div>
            </div>
        </div>

        <!-- running game view - shows the running game -->
        <div id="view-running" v-if="currentView === 'running'">
            <div id="players">
                <div v-bind:class="'player' + (index == gameState.game.currentPlayerIndex ? ' current' : '')" v-for="(player, index) in gameState.players" v-if="index != gameState.myIndex">
                    <div class="name">
                        {{ player.name != '' ? player.name : 'Spieler ' + (index+1) }}
                    </div>
                    <div class="cards">
                        {{ player.cardCount }}
                    </div>
                </div>
            </div>
            <div id="table">
                <div id="topCard" v-bind:class="gameState.game.desiredColor != null ? gameState.game.desiredColor.toLowerCase() : ''">
                    <picture>
                        <source v-bind:srcset="getCardImage(gameState.game.topCard, 'large')" media="(min-width: 860px)">
                        <source v-bind:srcset="getCardImage(gameState.game.topCard, 'small')" media="(max-width: 859px)">
                        <img v-bind:src="getCardImage(gameState.game.topCard, 'small')" alt="">
                    </picture>
                </div>
                <div id="say-uno">
                    <div>
                        <button>Uno sagen</button>
                    </div>
                </div>
                <div id="drawPile"></div>
            </div>
            <div id="ownCards" v-bind:class="gameState.myIndex == gameState.game.currentPlayerIndex ? 'current' : ''">
                <picture v-for="card in gameState.ownCards">
                    <source v-bind:srcset="getCardImage(card, 'large')" media="(min-width: 860px)">
                    <source v-bind:srcset="getCardImage(card, 'small')" media="(max-width: 859px)">
                    <img v-bind:src="getCardImage(card, 'small')" alt="">
                </picture>
            </div>
            <div id="color-selection" class="lightbox" v-if="gameState.game.turnState == 'SELECT_COLOR'">
                <div>
                    <div class="red"></div>
                    <div class="green"></div>
                    <div class="blue"></div>
                    <div class="yellow"></div>
                </div>
            </div>
            <div id="put-drawn" class="lightbox" v-if="gameState.game.turnState == 'PUT_DRAWN'">
                <div>
                    <img v-bind:src="getCardImage(gameState.ownCards[gameState.ownCards.length-1], 'large')" alt="">
                    <div>Möchtest du die gezogene Karte legen?</div>
                    <div class="buttons">
                        <button class="small yes">Ja</button>
                        <button class="small no">Nein</button>
                    </div>
                </div>
            </div>
            <div id="finished" class="lightbox" v-if="winner >= 0">
                <div>
                    <div v-if="winner == gameState.myIndex">
                        Herzlichen Glückwunsch, {{gameState.players[winner].name != '' ? gameState.players[winner].name : 'Spieler '+(winner+1)}}!<br>
                        Du hast gewonnen!
                    </div>
                    <div v-if="winner != gameState.myIndex">
                        Das Spiel ist beendet.<br>
                        {{gameState.players[winner].name != '' ? gameState.players[winner].name : 'Spieler '+(winner+1)}} hat gewonnen!
                    </div>
                    <button class="small">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast"></div>

    <script src="/res/js/app.js"></script>
    <script src="/res/js/app-requests.js"></script>
    <script src="/res/js/app-game.js"></script>
    <script src="/res/js/app-player.js"></script>
    <script src="/res/js/app-round.js"></script>
</body>
</html>